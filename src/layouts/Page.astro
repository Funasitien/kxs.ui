---
import Head from "./Head.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import { Icon } from "astro-icon/components";

const { frontmatter } = Astro.props;

// Predefine the glob for all potential directories (e.g., `/src/pages/example/*.md`)
const allMarkdownFiles = import.meta.glob("/src/pages/**/*.mdx", {
  eager: true,
});

// Get the current page's route
let currentPath = Astro.url.pathname;
if (currentPath.endsWith('/')) {
  currentPath = currentPath.slice(0, -1);
}

// Filter the files to only include those in the same directory
const currentDir = currentPath.replace(/\/[^/]*$/, "/"); // Get the directory path
const posts = Object.entries(allMarkdownFiles)
  .filter(([path]) => path.startsWith(`/src/pages${currentDir}`))
  .map(([, module]) => ({
    title: module.frontmatter.title,
    icon: module.frontmatter.icon,
    url: module.url,
  }));
---
<Head title={frontmatter.title} description={frontmatter.description}>
<Navbar />
<div class="drawer lg:drawer-open">
  <input id="my-drawer-2" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content max-w-screen">
    <h1 class="text-3xl lg:text-5xl font-bold m-2 my-4 lg:m-4 p-2 bg-primary rounded-lg flex flex-row max-w-fit text-base-100">
      <Icon name={frontmatter.icon} class="translate-y-0.5"/>
      <span class="ml-1">{frontmatter.title}</span>
    </h1>
    <article class="prose lg:prose-xl mx-2 lg:mx-4" style="max-width: none;">
      <slot />
    </article>
    <Footer />
  </div>
  <div class="drawer-side">
    <label for="my-drawer-2" aria-label="close sidebar" class="drawer-overlay"
    ></label>
    <ul class="menu bg-base-200 text-base-content min-h-full w-80 p-4">
      {
        posts.map((post) => (
          <li>
            <a href={post.url}>
              <Icon name={post.icon} />
              {post.title}
            </a>
          </li>
        ))
      }
      <li>
        <a href="../">Back ig</a>
      </li>
      <li>
        <select data-choose-theme class="select select-bordered">
          <option value="light">ğŸ’¡ Light</option>
          <option value="dark">ğŸŒ™ Dark</option>
          <option value="cupcake">ğŸ§ Cupcake</option>
          <option value="bumblebee">ğŸ Bumblebee</option>
          <option value="emerald">ğŸ’š Emerald</option>
          <option value="corporate">ğŸ¢ Corporate</option>
          <option value="synthwave">ğŸŒ‡ Synthwave</option>
          <option value="retro">ğŸ•¹ï¸ Retro</option>
          <option value="cyberpunk">ğŸ¤– Cyberpunk</option>
          <option value="valentine">â¤ï¸ Valentine</option>
          <option value="halloween">ğŸƒ Halloween</option>
          <option value="garden">ğŸŒº Garden</option>
          <option value="forest">ğŸŒ² Forest</option>
          <option value="aqua">ğŸ’§ Aqua</option>
          <option value="lofi">ğŸ“¼ Lo-Fi</option>
          <option value="pastel">ğŸŒˆ Pastel</option>
          <option value="fantasy">âœ¨ Fantasy</option>
          <option value="wireframe">ğŸ”® Wireframe</option>
          <option value="black">âš« Black</option>
          <option value="luxury">ğŸ° Luxury</option>
          <option value="dracula">ğŸ§›â€â™‚ï¸ Dracula</option>
          <option value="cmyk">ğŸ¨ CMYK</option>
          <option value="autumn">ğŸ Autumn</option>
          <option value="business">ğŸ’¼ Business</option>
          <option value="acid">ğŸ’Š Acid</option>
          <option value="lemonade">ğŸ‹ Lemonade</option>
          <option value="night">ğŸŒ™ Night</option>
          <option value="coffee">â˜• Coffee</option>
          <option value="winter">â„ï¸ Winter</option>
          <option value="dim">ğŸŒƒ Dim</option>
          <option value="nord">ğŸŒŒ Nord</option>
          <option value="sunset">ğŸŒ‡ Sunset</option>
        </select>
      </li>
    </ul>
  </div>
</div>
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>
</Head>
